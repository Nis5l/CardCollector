<div class="card-add-container" *ngIf="(card$ | async) as card">
  @if (config$ | async; as config) {
    @if (formGroup$ | async; as formGroup) {
      @if (collectorId$ | async; as cid) {
        <form [formGroup]="formGroup" (ngSubmit)="cardCreateRequest(card)">
          <mat-form-field>
            <input matInput type="text" formControlName="name" placeholder="Name" [minlength]="config.nameLengthMin" [maxlength]="config.nameLengthMax"/>
            <mat-error >Name has to be {{config.nameLengthMin}}-{{config.nameLengthMax}} characters</mat-error>
          </mat-form-field>
          <cc-card-type-selector [cardState]="CardState.Created" formControlName="type" [collectorId]="cid"></cc-card-type-selector>
          <input #imageInput hidden="true" type="file" (change)="imageChange($event.target)" accept="image/jpeg,image/png"/>
          <button matButton="outlined" type="button" (click)="imageInput.click()" [color]="formGroup.hasError('noImage') ? 'error' : 'text'"><mat-icon color="accent" svgIcon="add_a_photo"></mat-icon>Image</button>
          <div class="request">
            <div *ngVar="(error$ | async) as error" class="error">
              @if (error != null) {
                <mat-error>{{error}}</mat-error>
              }
            </div>
            <button matButton="outlined" type="submit" [disabled]="!formGroup.valid">Submit</button>
          </div>
        </form>
      }
    }
  }
  <div class="card">
    <cc-card [card]="card" [cardImage]="cardImage$ | async"></cc-card>
  </div>
</div>
